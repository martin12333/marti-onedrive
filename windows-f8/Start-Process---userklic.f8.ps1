


# f8_text_file
# (an f8_text_file is-not meant to be run as a whole)
)
exit

(selected lines from this file can be run in a terminal ... e.g. by the F8 key, customly bound to runSelectedText  )

echo '-------- section --------'

246
parent:

code windows-f8\New-LocalUser---Start-Process---userklic.f8.ps1


246 done
code powershell-f8\Start-Process.f8.ps1

echo '-------- section --------'


echo '-------- section --------'

246  do this  F8

$username = 'userklic'
$pass= cat "C:\Users\marti\OneDrive\tar-TAR-MA-SOUKR-KLIC\232i"
$Password=ConvertTo-SecureString $pass -AsPlainText -Force -Verbose
$credential = [PSCredential]::New($username,$password)



todo?
$username = 'techl'




echo '-------- section --------'


echo '-------- section --------'

echo '-------- section --------'



246
-UseNewEnvironment
####   This has the side effect that the $env:USERNAME is set to SYSTEM.
noooo, false-alarm ,  experim
USERNAME=userklic
:love:










Start-Process "conhost.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment  -LoadUserProfile



Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory C:\Users\$username   -UseNewEnvironment   -ArgumentList "/C",set   -RedirectStandardOutput "c:\Users\public\$username.env.OVERWRITE.txt"


file:///C:\Users\Public\userklic.env.OVERWRITE.txt
mart 0


APPDATA=C:\Users\userklic\AppData\Roaming

HOMEDRIVE=C:
HOMEPATH=\Users\userklic
LOCALAPPDATA=C:\Users\userklic\AppData\Local
NUMBER_OF_PROCESSORS=6
OneDrive=C:\Users\userklic\OneDrive

TEMP=C:\Users\userklic\AppData\Local\Temp
TMP=C:\Users\userklic\AppData\Local\Temp
USERDOMAIN=LEN20
USERNAME=userklic
USERPROFILE=C:\Users\userklic

Path=C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\WINDOWS\System32\OpenSSH\;C:\Program Files (x86)\Common Files\Acronis\VirtualFile\;C:\Program Files (x86)\Common Files\Acronis\VirtualFile64\;C:\Program Files (x86)\Common Files\Acronis\FileProtector\;C:\Program Files (x86)\Common Files\Acronis\FileProtector64\;C:\Program Files (x86)\Common Files\Acronis\SnapAPI\;C:\Program Files\dotnet\;C:\Program Files\PowerShell\7\;C:\Program Files\RedHat\Podman\;C:\Program Files\Tailscale\;C:\Program Files\nodejs\;C:\Program Files\Microsoft VS Code\bin;C:\Program Files\Git\cmd;C:\Users\userklic\AppData\Local\Microsoft\WindowsApps


$PSVersionTable

246 continue?
https://www.diigo.com/user/martin12333?query=Start-Process+.exe+Credential+










#******************

Start-Process "conhost.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment  -LoadUserProfile

#**************
file:///c:\Users\userklic\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

54*5454545454
node
python
cd .\conda\
dir
.\python.exe
hgjghjjhgjhgjgjgj
whoami.exe
C:
cd users
cd .\marti\
dir
ls
cd appdata
dir
cd ..
dir .\marti\
cd .\marti\
mkdir a
mkdir a46456464654646
explorer.exe
C:\pf\totalcmd\TOTALCMD64.EXE
cd ..\userklic\
dir
cmd /c dir
cmd /c dir /s
cmd /c dir /s /a


fail  0  semi   numdot
fail ahk

dir env/
dir envenv/
dir envenvenv/`
echo `!@#$%^&*()
echo '`!@#$%^&*()-=[{C:\pf\totalcmd\TOTALCMD64.EXE}]'
echo '`!@#$%^&*()-=[{C:\pf\totalcmd\TOTALCMD64.E''""XE}]'
echo '`!@#$%^&*()-=[{C:\pf\totalcmd\TOTALCMD64.E''""XE}]''""'
echo '`!@#$%^&*()-=[{C:\pf\totalcmd\TOTALCM,.//D64.E''""XE}]''""'
echo '`!@#$%^&*()-=[{C:\pf\totalcmd\TOTALCM,.//D64.E''""XE}]''"```"'
exit





###
if without conhost
nejde psat, paste
Start-Process pwsh.exe -Credential $Credential -WorkingDirectory d:\    -Verbose -UseNewEnvironment -LoadUserProfile



#-ArgumentList "-Command","Write-host 'Hello Profile'"
##-ScriptBlock { whoami /all }





Start-Process "cmd.exe" -Credential $credential  -WorkingDirectory C:\Users\userklic   -UseNewEnvironment -ArgumentList "/C",dir,/a,/s,'&',pause   #works


Total Files Listed:
		 98 File(s)      2,888,731 bytes
		238 Dir(s)  31,456,952,320 bytes free


after notepad env
		Total Files Listed:
		114 File(s)      5,224,987 bytes
		247 Dir(s)  31,452,971,008 bytes free
Press any key to continue . . .

Total Files Listed:
132 File(s)      7,207,724 bytes
253 Dir(s)  25,007,968,256 bytes free





###Start-Process "notepad.exe" -Credential $credential   -WorkingDirectory D:\


Start-Process "notepad.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment   -LoadUserProfile

#Start-Process "wt.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment  -LoadUserProfile

Start-Process "conhost.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment  -LoadUserProfile

wt
conhost.exe


cmd /c pause
cmd /c dir d: /p '&' pause


-ArgumentList "/C" -LoadUserProfile









#################################


Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory d:\   -UseNewEnvironment -ArgumentList "/C",pause   #works
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory d:\   -UseNewEnvironment -ArgumentList "/C",dir,/p   #works
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory C:\Windows\System32   -UseNewEnvironment -ArgumentList "/C",dir,/p   #works
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory d:\ -UseNewEnvironment -ArgumentList "/C",dir,/p   #works

Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory D:\umarti   -UseNewEnvironment -ArgumentList "/C",dir # flick

Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory D:\ -ArgumentList "/C",dir,/p,/s,C:\Users
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory D:\ -ArgumentList "/C",cmd

-WorkingDirectory D:\umarti   -UseNewEnvironment



https://stackoverflow.com/questions/72842792/activate-local-user-just-after-creating-it-with-powershell





Start-Process powershell.exe -Credential $Credential  -ArgumentList "-Command","Write-host 'Hello Profile' ;  sleep 10 "     -WorkingDirectory D:\


########################








#conpty  ... could fail on multiuser





















win=q process explorer

file:///c:\Users\marti\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

icacls.exe  'C:\Program files\windowsapps'
icacls.exe  'C:\Program files'
icacls.exe  C:\Pf\windowsapps
cmd /c dir C:\Pf\windowsapps /a /q
cmd /c dir  "C:\Program Files\WindowsApps\Microsoft.SysinternalsSuite_2022.11.1.0_x64__8wekyb3d8bbwe\Tools\"
. "C:\Program Files\WindowsApps\Microsoft.SysinternalsSuite_2022.11.1.0_x64__8wekyb3d8bbwe\Tools\junction.exe"

cmd /c dir  "C:\Program Files\WindowsApps\Microsoft.SysinternalsSuite_2023.1.0.0_x64__8wekyb3d8bbwe\" /s /a

win-x admin


11/11/2022  18:45         2,395,536 procexp.exe








C:\pf\totalcmd\TOTALCMD64.EXE D:\umarti


wt.exe

file:///D:\umarti\powershell_eternal_history.txt


# safer ... better sth like  get-content   than   `cat`
Get-Alias  cat

#$username = 'micha'






# why comment-out
# maybe i forgot, that in windows, to do ~~runas, i have to make a new window /// or perhaps  use the windows sudo, but that is very new now

#Start-Process pwsh.exe -Credential $Credential -WorkingDirectory d:\    -Verbose -UseNewEnvironment
###Start-Process node.exe -Credential $Credential -WorkingDirectory d:\    -Verbose -UseNewEnvironment -ArgumentList '-i'

Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory D:\Users   -UseNewEnvironment   -ArgumentList "/C",set   -RedirectStandardOutput "c:\Users\public\a"

HOMEDRIVE=D:
HOMEPATH=\Users

Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory d:\   -UseNewEnvironment -ArgumentList "/C",pause   #works

https://www.itdroplets.com/run-a-command-as-a-different-user-in-powershell/
