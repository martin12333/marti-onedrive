

# (a file in the mm_f8_doc pseudo-format)
do-not run this file as a whole
)
exit

(selected lines from this file can be run in a terminal ... e.g. by the F8 key, customly bound to runSelectedText  )

echo '-------- section --------'



wt.exe

file:///D:\umarti\powershell_eternal_history.txt

$username = 'userklic'
$pass= cat "C:\Users\marti\OneDrive\tar-TAR-MA-SOUKR-KLIC\232i"
$Password=ConvertTo-SecureString $pass -AsPlainText -Force -Verbose
$credential = [PSCredential]::New($username,$password)

#Start-Process pwsh.exe -Credential $Credential -WorkingDirectory d:\    -Verbose -UseNewEnvironment
###Start-Process node.exe -Credential $Credential -WorkingDirectory d:\    -Verbose -UseNewEnvironment -ArgumentList '-i'











#file:///c:\Users\marti\admin-ise--adminsaves.f8.ps1
BETTER COPY PASTE INTO admin ise / admin-ise--adminsaves.f8.ps1

file:///c:\Users\marti\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

win-x admin

WIN-Q ise admin open

resto.point
pre New-LocalUser
inst
reboot
resto.point



#security

icacls.exe C:\Users\marti\
icacls.exe C:\Users\marti\OneDrive
icacls.exe C:\Users\milan_rxtipwr\
icacls.exe C:\Users\milan_rxtipwr\OneDrive



echo fdgf > "C:\Users\marti\OneDrive\tar-TAR-MA-SOUKR-KLIC\232i"

file:///C:\Users\marti\OneDrive\tar-TAR-MA-SOUKR-KLIC\232i
#mc

echo $(cat "C:\Users\marti\OneDrive\tar-TAR-MA-SOUKR-KLIC\232i")

#./apgluxe -L 1 -t 1 -k `cat ~/grdr20/klic`   --rule r2b7t8s6t10    -n 10000  #cd apgmera/








I had to use your ADSI method as New-LocalUser was throwing errors about not meeting password complexity requirements.







Variable names aren't case-sensitive,'
ps7 yes
$username = 'u232i'
$username = 'userklic'
echo $Username
$PSVersionTable


$pass= cat "C:\Users\marti\OneDrive\tar-TAR-MA-SOUKR-KLIC\232i"
$pass
$Password=ConvertTo-SecureString $pass -AsPlainText -Force -Verbose -Debug
$Password.Length


#
#
#
$Password = ConvertTo-SecureString -AsPlainText $pass -Force
$password = 'NewProfilePassword' | ConvertTo-SecureString -AsPlainText -Force
$password = ConvertTo-SecureString "LazyAdminPwd123!" -AsPlainText -Force  # Super strong plane text password here (yes this isn't secure at all)







Get-LocalUser

-WhatIf


#file:///c:\Users\marti\admin-ise--adminsaves.f8.ps1
BETTER COPY PASTE INTO admin ise / admin-ise--adminsaves.f8.ps1
file:///c:\Users\marti\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

powershell.exe
$PSVersionTable

$username = 'userklic'
$pass= cat "C:\Users\marti\OneDrive\tar-TAR-MA-SOUKR-KLIC\232i"
$Password=ConvertTo-SecureString $pass -AsPlainText -Force -Verbose

New-LocalUser -AccountNeverExpires -PasswordNeverExpires  -Verbose -Debug  -Name "$username" -Password $password -FullName "$username"     #-Description "Lazy Test user"





Get-LocalUser

ls C:\Users


. "C:\Users\milan_rxtipwr\OneDrive\Plocha\du64-mujlen-podpisy\du64"   C:\Users\Eda

C:\Users\milan_rxtipwr\OneDrive\Plocha\du64-mujlen-podpisy\du64   C:\Users\milan_rxtipwr
C:\Users\milan_rxtipwr\OneDrive\Plocha\du64-mujlen-podpisy\du64   C:\Users\userklic


icacls.exe  C:\Users\userklic   /grant 'marti:(oi)(ci)(f)'
"C:\Users\userklic.zip"









net user $username

Password required            No

Workstations allowed         All
Logon script
User profile
Home directory
Last logon                   Never


Local Group Memberships
Global Group memberships     *None







net user Eda

User name                    Eda
Full Name                    Edovo Nastaveni

Password expires             03/09/2021 18:11:27
Password expires             Never

Password required            Yes

Workstations allowed         All
Logon script
User profile
Home directory
Last logon                   01/26/2021 18:11:25

Logon hours allowed          All

Local Group Memberships      *nonadmins1
*Users

papir a5 group deny udajne nefunguji

Global Group memberships     *None


###dsquery user -name "edovo Nastaveni"





Set-LocalUser -Name Eda -PasswordNeverExpires $true



$x=get-LocalUser -Name Eda
$?
$x.

Get-StorageDiagnosticInfo
Get-PSHostProcessInfo




######################







Add-LocalGroupMember -Group Users -Member $username








Add-LocalGroupMember -Group "Administrators" -Member $UNameLocal
Add-LocalGroupMember -Group $gr -Member $user

$Cred = New-Object System.Management.Automation.PSCredential ("$username", $Password)

######################





-WhatIf-WhatIf


$credential = [PSCredential]::New($username,$password)





#******************

Start-Process "conhost.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment  -LoadUserProfile

#**************
file:///c:\Users\userklic\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

54*5454545454
node
python
cd .\conda\
dir
.\python.exe
hgjghjjhgjhgjgjgj
whoami.exe
C:
cd users
cd .\marti\
dir
ls
cd appdata
dir
cd ..
dir .\marti\
cd .\marti\
mkdir a
mkdir a46456464654646
explorer.exe
C:\pf\totalcmd\TOTALCMD64.EXE
cd ..\userklic\
dir
cmd /c dir
cmd /c dir /s
cmd /c dir /s /a





###
if without conhost
nejde psat, paste
Start-Process pwsh.exe -Credential $Credential -WorkingDirectory d:\    -Verbose -UseNewEnvironment -LoadUserProfile



#-ArgumentList "-Command","Write-host 'Hello Profile'"
##-ScriptBlock { whoami /all }





Start-Process "cmd.exe" -Credential $credential  -WorkingDirectory C:\Users\userklic   -UseNewEnvironment -ArgumentList "/C",dir,/a,/s,'&',pause   #works


Total Files Listed:
		 98 File(s)      2,888,731 bytes
		238 Dir(s)  31,456,952,320 bytes free


after notepad env
		Total Files Listed:
		114 File(s)      5,224,987 bytes
		247 Dir(s)  31,452,971,008 bytes free
Press any key to continue . . .

Total Files Listed:
132 File(s)      7,207,724 bytes
253 Dir(s)  25,007,968,256 bytes free





###Start-Process "notepad.exe" -Credential $credential   -WorkingDirectory D:\


Start-Process "notepad.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment   -LoadUserProfile

#Start-Process "wt.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment  -LoadUserProfile

Start-Process "conhost.exe" -Credential $credential   -WorkingDirectory D:\ -UseNewEnvironment  -LoadUserProfile

wt
conhost.exe


cmd /c pause
cmd /c dir d: /p '&' pause


-ArgumentList "/C" -LoadUserProfile









#################################


Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory d:\   -UseNewEnvironment -ArgumentList "/C",pause   #works
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory d:\   -UseNewEnvironment -ArgumentList "/C",dir,/p   #works
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory C:\Windows\System32   -UseNewEnvironment -ArgumentList "/C",dir,/p   #works
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory d:\ -UseNewEnvironment -ArgumentList "/C",dir,/p   #works

Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory D:\umarti   -UseNewEnvironment -ArgumentList "/C",dir # flick

Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory D:\ -ArgumentList "/C",dir,/p,/s,C:\Users
Start-Process "cmd.exe" -Credential $credential   -WorkingDirectory D:\ -ArgumentList "/C",cmd

-WorkingDirectory D:\umarti   -UseNewEnvironment


#############################
Hello when I create a user in powershell with New-LocalUser, I was wondering if there was a way to "activate" that user without connecting to it.

New-LocalUser -Name $UNameLocal -Description $UDescription -Password $Password -AccountNeverExpires -Confirm

$Password = ConvertTo-SecureString -AsPlainText $pass -Force
New-LocalUser $user -Password $Password -PasswordNeverExpires




$username = 'NewUsername'
$password = 'NewProfilePassword' | ConvertTo-SecureString -AsPlainText -Force

########################





















AAAAps-jilen\ConsoleHost_history.txt:


net user
net user /help
net user
net user Ljuba /add /active:yes
net user Ljuba *
net localgroup
net localgroup users
net localgroup users Ljuba
net localgroup users Ljuba /delete
net localgroup users
net localgroup users Ljuba /add
net localgroup users
net localgroup users Ljuba /delete
net localgroup guests Ljuba /add
net localgroup guests




net user Eda /add /active:yes
e:
net user Eda /add /active:yes
net user Eda /add /active:yes
net user Eda *
net user Eda *
net user Ljuba *
net localgroup users Ljuba /add
net localgroup guests Ljuba /delete
net localgroup guests
net localgroup users










tar-exe\d\umarti\powershell_eternal_history.txt:


net user pokus9 /add /active:yes
echo anaconda
net user pokus9 /add /active:yes
net user pokus9 *
net localgroup users









BUG BUUUUUUUUUUUUUUUUG  DIIGO

runas  /showtrustlevels
The following trust levels are available on your system:
0x20000 (Basic User)
BUG BUUUUUUUUUUUUUUUUG  DIIGO



/savecred         to use credentials previously saved by the user.


/env              to use current environment instead of user's.'

/noprofile        specifies that the user's profile should not be loaded.
This causes the application to load more quickly, but
can cause some applications to malfunction.

/profile          specifies that the user's profile should be loaded.
This is the default.

HKCU?







win=q process explorer

file:///c:\Users\marti\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

icacls.exe  'C:\Program files\windowsapps'
icacls.exe  'C:\Program files'
icacls.exe  C:\Pf\windowsapps
cmd /c dir C:\Pf\windowsapps /a /q
cmd /c dir  "C:\Program Files\WindowsApps\Microsoft.SysinternalsSuite_2022.11.1.0_x64__8wekyb3d8bbwe\Tools\"
. "C:\Program Files\WindowsApps\Microsoft.SysinternalsSuite_2022.11.1.0_x64__8wekyb3d8bbwe\Tools\junction.exe"

cmd /c dir  "C:\Program Files\WindowsApps\Microsoft.SysinternalsSuite_2023.1.0.0_x64__8wekyb3d8bbwe\" /s /a

win-x admin


11/11/2022  18:45         2,395,536 procexp.exe




